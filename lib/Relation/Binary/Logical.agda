{-# OPTIONS --without-K #-}
{-# OPTIONS --universe-polymorphism #-}
module Relation.Binary.Logical where

open import Type hiding (โ)
open import Level.NP
open import Algebra.FunctionProperties
open import Data.Product
open import Data.Zero
open import Data.One
open import Relation.Nullary
open import Relation.Unary.NP hiding (Decidable)
open import Relation.Binary

โฆโโง : โ {aโ aโ} aแตฃ (Aโ : โ aโ) (Aโ : โ aโ) โ โ _
โฆโโง aแตฃ Aโ Aโ = Aโ โ Aโ โ โ aแตฃ

โฆโโงโ : โ {aโ aโ} (Aโ : โ aโ) (Aโ : โ aโ) โ โ _
โฆโโงโ = โฆโโง โ

โฆโโโง : โ (Aโ Aโ : โโ) โ โโ
โฆโโโง = โฆโโงโ

โฆโโโง : โ (Aโ Aโ : โโ) โ โโ
โฆโโโง = โฆโโง (โ โ)

-- old name
โฆSetโง : โ {aโ aโ} aแตฃ (Aโ : โ aโ) (Aโ : โ aโ) โ โ _
โฆSetโง aแตฃ Aโ Aโ = Aโ โ Aโ โ โ aแตฃ

-- old name (simpler internal representation: no use of defined names, no patterns)
โฆSetโโง : โ (Aโ Aโ : Setโ) โ Setโ
โฆSetโโง = ฮป Aโ Aโ โ Aโ โ Aโ โ Setโ

-- old name (see โฆSetโโง)
โฆSetโโง : โ (Aโ Aโ : Setโ) โ Setโ
โฆSetโโง = ฮป Aโ Aโ โ Aโ โ Aโ โ Setโ

โฆฮโง : โ {aโ aโ aแตฃ} {Aโ : โ aโ} {Aโ : โ aโ} (Aแตฃ : Aโ โ Aโ โ โ aแตฃ)
         {bโ bโ bแตฃ} {Bโ : Aโ โ โ bโ} {Bโ : Aโ โ โ bโ} (Bแตฃ : โ {xโ xโ} (xแตฃ : Aแตฃ xโ xโ) โ Bโ xโ โ Bโ xโ โ โ bแตฃ)
         (fโ : (x : Aโ) โ Bโ x) (fโ : (x : Aโ) โ Bโ x) โ โ _
โฆฮโง Aแตฃ Bแตฃ = ฮป fโ fโ โ โ {xโ xโ} (xแตฃ : Aแตฃ xโ xโ) โ Bแตฃ xแตฃ (fโ xโ) (fโ xโ)

infixr 0 โฆฮโง
syntax โฆฮโง Aแตฃ (ฮป xแตฃ โ f) = โจ xแตฃ โถ Aแตฃ โฉโฆโโง f

โฆฮโงe : โ {aโ aโ aแตฃ} {Aโ : โ aโ} {Aโ : โ aโ} (Aแตฃ : Aโ โ Aโ โ โ aแตฃ)
         {bโ bโ bแตฃ} {Bโ : Aโ โ โ bโ} {Bโ : Aโ โ โ bโ} (Bแตฃ : โ {xโ xโ} (xแตฃ : Aแตฃ xโ xโ) โ Bโ xโ โ Bโ xโ โ โ bแตฃ)
         (fโ : (x : Aโ) โ Bโ x) (fโ : (x : Aโ) โ Bโ x) โ โ _
โฆฮโงe Aแตฃ Bแตฃ = ฮป fโ fโ โ โ xโ xโ (xแตฃ : Aแตฃ xโ xโ) โ Bแตฃ xแตฃ (fโ xโ) (fโ xโ)

โฆโโง : โ {aโ aโ aแตฃ} {Aโ : โ aโ} {Aโ : โ aโ} (Aแตฃ : Aโ โ Aโ โ โ aแตฃ)
         {bโ bโ bแตฃ} {Bโ : Aโ โ โ bโ} {Bโ : Aโ โ โ bโ} (Bแตฃ : โ {xโ xโ} (xแตฃ : Aแตฃ xโ xโ) โ Bโ xโ โ Bโ xโ โ โ bแตฃ)
         (fโ : {x : Aโ} โ Bโ x) (fโ : {x : Aโ} โ Bโ x) โ โ _
โฆโโง Aแตฃ Bแตฃ = ฮป fโ fโ โ โ {xโ xโ} (xแตฃ : Aแตฃ xโ xโ) โ Bแตฃ xแตฃ (fโ {xโ}) (fโ {xโ})

infixr 0 โฆโโง
syntax โฆโโง Aแตฃ (ฮป xแตฃ โ f) = โโจ xแตฃ โถ Aแตฃ โฉโฆโโง f

infixr 1 _โฆโโง_
_โฆโโง_ : โ {aโ aโ aแตฃ} {Aโ : โ aโ} {Aโ : โ aโ} (Aแตฃ : Aโ โ Aโ โ โ aแตฃ)
          {bโ bโ bแตฃ} {Bโ : โ bโ} {Bโ : โ bโ} (Bแตฃ : Bโ โ Bโ โ โ bแตฃ)
          (fโ : Aโ โ Bโ) (fโ : Aโ โ Bโ) โ โ _
Aแตฃ โฆโโง Bแตฃ = โฆฮโง Aแตฃ (ฮป _ โ Bแตฃ)

infixr 0 _โฆโโงe_
_โฆโโงe_ : โ {aโ aโ aแตฃ} {Aโ : โ aโ} {Aโ : โ aโ} (Aแตฃ : Aโ โ Aโ โ โ aแตฃ)
          {bโ bโ bแตฃ} {Bโ : โ bโ} {Bโ : โ bโ} (Bแตฃ : Bโ โ Bโ โ โ bแตฃ)
          (fโ : Aโ โ Bโ) (fโ : Aโ โ Bโ) โ โ _
_โฆโโงe_ Aแตฃ Bแตฃ = โฆฮโงe Aแตฃ (ฮป _ โ Bแตฃ)

infixr 1 _โโง_
_โโง_ : โ {a bโ bโ bแตฃ} (A : โ a) {Bโ : โ bโ} {Bโ : โ bโ} (Bแตฃ : โฆโโง bแตฃ Bโ Bโ) โ โฆโโง _ (A โ Bโ) (A โ Bโ)
(A โโง Bแตฃ) fโ fโ = โ (x : A) โ Bแตฃ (fโ x) (fโ x)

ฮโง : โ {a bโ bโ bแตฃ} (A : โ a) {Bโ : A โ โ bโ} {Bโ : A โ โ bโ} (Bแตฃ : (A โโง โฆโโง bแตฃ) Bโ Bโ) โ โฆโโง _ ((x : A) โ Bโ x) ((x : A) โ Bโ x)
ฮโง A Bแตฃ fโ fโ = โ (x : A) โ Bแตฃ x (fโ x) (fโ x)

infixr 0 ฮโง
syntax ฮโง A (ฮป x โ f) = โจ x โถ A โฉโโง f

โโง : โ {a} (A : โ a)
       {bโ bโ bแตฃ} {Bโ : A โ โ bโ} {Bโ : A โ โ bโ} (Bแตฃ : โ x โ Bโ x โ Bโ x โ โ bแตฃ)
       (fโ : {x : A} โ Bโ x) (fโ : {x : A} โ Bโ x) โ โ _
โโง A Bแตฃ fโ fโ = {x : A} โ Bแตฃ x (fโ {x}) (fโ {x})

infixr 0 โโง
syntax โโง A (ฮป x โ f) = โโจ x โถ A โฉโโง f

-- Non universe polymorphic versions

infixr 1 _โฆโโโโง_ _โฆโโโโง_ _โฆโโโโง_

_โฆโโโโง_ : โ {Aโ Aโ : โโ} (Aแตฃ : Aโ โ Aโ โ โโ)
          {Bโ Bโ : โโ} (Bแตฃ : Bโ โ Bโ โ โโ)
          (fโ : Aโ โ Bโ) (fโ : Aโ โ Bโ) โ โโ
_โฆโโโโง_ = ฮป {Aโ} {Aโ} Aแตฃ {Bโ} {Bโ} Bแตฃ fโ fโ โ โ {xโ xโ} (xแตฃ : Aแตฃ xโ xโ) โ Bแตฃ (fโ xโ) (fโ xโ)

_โฆโโโโง_ : โ {Aโ Aโ : โโ} (Aแตฃ : Aโ โ Aโ โ โโ)
          {Bโ Bโ : โโ} (Bแตฃ : Bโ โ Bโ โ โโ)
          (fโ : Aโ โ Bโ) (fโ : Aโ โ Bโ) โ โโ
_โฆโโโโง_ = ฮป {Aโ} {Aโ} Aแตฃ {Bโ} {Bโ} Bแตฃ fโ fโ โ โ {xโ xโ} (xแตฃ : Aแตฃ xโ xโ) โ Bแตฃ (fโ xโ) (fโ xโ)

_โฆโโโโง_ : โ {Aโ Aโ : โโ} (Aแตฃ : Aโ โ Aโ โ โโ)
          {Bโ Bโ : โโ} (Bแตฃ : Bโ โ Bโ โ โโ)
          (fโ : Aโ โ Bโ) (fโ : Aโ โ Bโ) โ โโ
_โฆโโโโง_ = ฮป {Aโ} {Aโ} Aแตฃ {Bโ} {Bโ} Bแตฃ fโ fโ โ โ {xโ xโ} (xแตฃ : Aแตฃ xโ xโ) โ Bแตฃ (fโ xโ) (fโ xโ)

record โฆ๐โง (xโ xโ : ๐) : โโ where
  constructor โฆ0โโง

data โฆ๐โง (xโ xโ : ๐) : โโ where

infix 3 โฆยฌโง_

โฆยฌโง_ : โ {aโ aโ aโ} โ (โฆโโง {aโ} {aโ} aโ โฆโโง โฆโโง _) ยฌ_ ยฌ_
โฆยฌโง Aแตฃ = Aแตฃ โฆโโง โฆ๐โง

-- Products โฆฮฃโง, โฆโโง, โฆรโง are in Data.Product.NP

โฆPredโง : โ {pโ pโ} pแตฃ {aโ aโ aแตฃ} โ (โฆโโง {aโ} {aโ} aแตฃ โฆโโง โฆโโง _) (Pred pโ) (Pred pโ)
โฆPredโง pแตฃ Aแตฃ = Aแตฃ โฆโโง โฆโโง pแตฃ

private
  RELโฒ : โ โ {a b} โ โ a โ โ b โ โ (a โ b โ โ โ)
  RELโฒ โ A B = A โ B โ โ โ

  โฆRELโงโฒ : โ {aโ aโ aแตฃ bโ bโ bแตฃ rโ rโ} rแตฃ โ
          (โฆโโง {aโ} {aโ} aแตฃ โฆโโง โฆโโง {bโ} {bโ} bแตฃ โฆโโง โฆโโง _) (RELโฒ rโ) (RELโฒ rโ)
  โฆRELโงโฒ rแตฃ Aแตฃ Bแตฃ = Aแตฃ โฆโโง Bแตฃ โฆโโง (โฆโโง rแตฃ)

โฆRELโง : โ {aโ aโ aแตฃ} {Aโ : โ aโ} {Aโ : โ aโ} (Aแตฃ : Aโ โ Aโ โ โ aแตฃ)
          {bโ bโ bแตฃ} {Bโ : โ bโ} {Bโ : โ bโ} (Bแตฃ : Bโ โ Bโ โ โ bแตฃ)
          {rโ rโ} rแตฃ (โผโ : REL Aโ Bโ rโ) (โผโ : REL Aโ Bโ rโ) โ โ _
โฆRELโง Aแตฃ Bแตฃ rแตฃ = Aแตฃ โฆโโง Bแตฃ โฆโโง (โฆโโง rแตฃ)

โฆRelโง : โ {aโ aโ aแตฃ} {Aโ : โ aโ} {Aโ : โ aโ} (Aแตฃ : Aโ โ Aโ โ โ aแตฃ)
          {rโ rโ} โแตฃ (โผโ : Rel Aโ rโ) (โผโ : Rel Aโ rโ) โ โ _
โฆRelโง Aแตฃ rแตฃ = โฆRELโง Aแตฃ Aแตฃ rแตฃ

data โฆDecโง {โโ โโ โแตฃ} {Pโ : โ โโ} {Pโ : โ โโ} (Pแตฃ : Pโ โ Pโ โ โ โแตฃ) : โฆโโง (โโ โ โโ โ โแตฃ) (Dec Pโ) (Dec Pโ) where
  yes : {pโ : Pโ} {pโ : Pโ} (pแตฃ : Pแตฃ pโ pโ) โ โฆDecโง Pแตฃ (yes pโ) (yes pโ)
  no  : {ยฌpโ : ยฌ Pโ} {ยฌpโ : ยฌ Pโ} (ยฌpแตฃ : (โฆยฌโง Pแตฃ) ยฌpโ ยฌpโ) โ โฆDecโง Pแตฃ (no ยฌpโ) (no ยฌpโ)

private
  โฆDecโง' : โ {pโ} {pโ} {pแตฃ} โ โฆPredโง {pโ} {pโ} _ (โฆโโง pแตฃ) Dec Dec
  โฆDecโง' = โฆDecโง

โฆDecidableโง : โ {aโ aโ aแตฃ bโ bโ bแตฃ โโ โโ โแตฃ}
              โ (โโจ Aแตฃ โถ โฆโโง {aโ} {aโ} aแตฃ โฉโฆโโง
                 โโจ Bแตฃ โถ โฆโโง {bโ} {bโ} bแตฃ โฉโฆโโง
                   โฆRELโง Aแตฃ Bแตฃ {โโ} {โโ} โแตฃ โฆโโง โฆโโง _) Decidable Decidable
โฆDecidableโง Aแตฃ Bแตฃ _โผแตฃ_ = โจ xแตฃ โถ Aแตฃ โฉโฆโโง โจ yแตฃ โถ Bแตฃ โฉโฆโโง โฆDecโง (xแตฃ โผแตฃ yแตฃ)

โฆOpโโง : โ {aโ aโ aแตฃ} โ (โฆโโง {aโ} {aโ} (aโ โ aโ โ aแตฃ) โฆโโง โฆโโง _) Opโ Opโ
โฆOpโโง Aแตฃ = Aแตฃ โฆโโง Aแตฃ

โฆOpโโง : โ {aโ aโ aแตฃ} โ (โฆโโง {aโ} {aโ} (aโ โ aโ โ aแตฃ) โฆโโง โฆโโง _) Opโ Opโ
โฆOpโโง Aแตฃ = Aแตฃ โฆโโง Aแตฃ โฆโโง Aแตฃ

open import Function.Equivalence
private
  โฆโโงโPreserves :
    โ {a b aแตฃ bแตฃ}
      {A : โ a} {B : โ b}
      {Aแตฃ : โฆโโง aแตฃ A A}
      {Bแตฃ : โฆโโง bแตฃ B B}
      {f}
    โ (Aแตฃ โฆโโง Bแตฃ) f f โ f Preserves Aแตฃ โถ Bแตฃ

  โฆโโงโPreserves = equivalence (ฮป x โ x) (ฮป x โ x)

  โฆโโงยฒโPreservesโ :
    โ {a b c aแตฃ bแตฃ cแตฃ}
      {A : โ a} {B : โ b} {C : โ c}
      {Aแตฃ : โฆโโง aแตฃ A A}
      {Bแตฃ : โฆโโง bแตฃ B B}
      {Cแตฃ : โฆโโง cแตฃ C C}
      {f}
    โ (Aแตฃ โฆโโง Bแตฃ โฆโโง Cแตฃ) f f โ f Preservesโ Aแตฃ โถ Bแตฃ โถ Cแตฃ

  โฆโโงยฒโPreservesโ = equivalence (ฮป f {x} {y}   {_} {_} z โ f {x} {y} z)
                                (ฮป f {x} {y} z {_} {_}   โ f z)

โฆInjโง : โ {aโ aโ aแตฃ} {Aโ : โ aโ} {Aโ : โ aโ} (Aแตฃ : โฆโโง aแตฃ Aโ Aโ)
          {bโ bโ bแตฃ} {Bโ : โ bโ} {Bโ : โ bโ} (Bแตฃ : โฆโโง bแตฃ Bโ Bโ)
          (fโ : Aโ โ Bโ) (fโ : Aโ โ Bโ) โ โ _
โฆInjโง Aแตฃ Bแตฃ fโ fโ = โ {xโ xโ} (xแตฃ : Bแตฃ (fโ xโ) (fโ xโ)) โ Aแตฃ xโ xโ

โฆInjโงโฒ : โ {a aแตฃ} {A : โ a} (Aแตฃ : โฆโโง aแตฃ A A)
           {b bแตฃ} {B : โ b} (Bแตฃ : โฆโโง bแตฃ B B)
           (f : A โ B) โ โ _
โฆInjโงโฒ Aแตฃ Bแตฃ f = โฆInjโง Aแตฃ Bแตฃ f f
